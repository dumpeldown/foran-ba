\chapter{Diskussion}
\label{chap:diskussion}
\section{Interpretation der Ergebnisse}
\label{sec:interpretation}
In diesem Kapitel werden die von \gls{acema} generierten Diagramme interpretiert sowie die Ergebnisse der Implementierung des Dashboards bewertet.
\subsection{Interpretation der ACEMA Diagramme}
\label{sec:interpretation-acema}
Über das Analyseskript der \gls{acema} Implementierung lassen sich verschiedene Arten von Diagrammen erstellen. Für die Analyse der Daten wurden Diagramme der Typen Heatmap-, Netz- und Balkendiagramm erstellt. Eine Auswahl von besonders relevanten Diagrammen ist in Anhang \ref{app:acema-diagrams} zu finden. Alle Diagramme sind über das Github-Repository \autocite{jesseDumpeldownAcema_oranDev} abrufbar und über den bereitgestellen Quellcode reproduzierbar. Im Folgenden werden drei der Diagramme genauer betrachtet und interpretiert.
\par Das Netzdiagramm in Abbildung \ref{app:fig-acema-radar} zeigt den durchschnittlichen \gls{cvss} Vektor der Metriken aus der Basisgruppe gruppiert nach dem Schweregrad (\textit{baseSeverity}). Dieser wird aus dem arithmetischen Mittel aller Vektoren (\(N = 353\)) berechnet, die mittels \gls{acema} gefunden werden. Die Metriken \textit{Access Vector}, \textit{Access Complexity} und \textit{Authentication} geben an, wie auf die Schwachstelle zugegriffen wurde und ob für den Zugriff weitere Hürden überwunden werden mussten. Die \textit{Impact}-Metriken geben an, wie schwer die Auswirkung in den jeweiligen Kategorien nach erfolgreicher Ausnutzung wären \autocite{CVSSV2Complete}. Zum Verständnis des Netzdiagramms ist die Erklärung in Anhang \ref{app:acema-diagrams} über die Umwandlung von textueller zu numerischer Darstellung hilfreich. Vereinfacht ergibt sich die Beobachtung: Je weiter das Netz nach \textit{außen} spannt, desto \textit{gefährlicher} ist ein \gls{cve}.
\par Der Zugriff auf die durchschnittliche Schwachstelle bei mittlerem (\(n = 154\)) oder hohem (\(n = 191\)) Schweregrad kann in den meisten Fällen über das Netzwerk erfolgen. Eine weitere Authentifizierung muss nicht umgangen werden, um Zugriff zu erlangen. Die Komplexität des Zugriffs befindet sich zwischen hoher und mittlerer Komplexität. Die Auswirkungen sind bei hohem Schweregrad jedoch um ungefähr 0,25 Punkt größer als bei mittlerem Schweregrad, und beeinträchtigen die Integrität, Verfügbarkeit und Vertraulichkeit des Systems durchschnittlich teilweise. Bei \glspl{cve} mit niedrigem Schweregrad ist eine deutliche Zunahme der Zugriffskomplexität erkennbar. Dies hängt auch damit zusammen, dass der initiale Zugriff häufiger nicht über das direkte Netzwerk möglich ist, sondern über benachbarte Netzwerke erfolgt. Mit Ausnahme der Auswirkung auf Integrität sind die Auswirkungen nochmals deutlich schwächer als bei mittlerem Schweregrad. Der Ausreißer könnte auf die geringe Stichprobe von \(n = 8\) aus der Grundgesamtheit von \(N = 353\) zurückzuführen sein.
\par Es ist aus der Anzahl der Stichproben pro Schweregrad deutlich erkennbar, dass den im Dashboard dargestellten \gls{mitre}-Techniken signifikant häufiger \glspl{cve} mit hohem oder mittlerem Schweregrad zugeordnet werden als solche mit niedrigem Schweregrad. Das lässt sich mit der Tatsache verknüpfen, dass \gls{open-ran} Systeme standardmäßig mit dem Netzwerk verbunden sind, um ihrer Funktion als Netzwerkinfrastruktur gerecht zu werden. Diese Schnittstelle erhöht die Möglichkeit und reduziert die Komplexität eines Zugriffs.
\par Abbildung \ref{app:fig-acema-mean-teq} zeigt den Durchschnitt der \gls{cvss} Gesamtbewertung pro Schweregrad und \gls{mitre}-Technik. Auffallend sind hier vier Techniken, bei denen der Durchschnitt der Bewertung bei hohem Schweregrad 8 übersteigt. Zwei der vier Techniken werden im Folgenden genauer betrachtet.
\par Eine der Techniken ist \textit{T1059}, die in der \gls{tm4k} die Bezeichnung \textit{Bash or cmd inside container} trägt \autocite{BashCmdContainer}. Es handelt sich dabei um Angriffe, die es erlauben bösartigen Code innerhalb eines Containers in einer Kubernetes Umgebung aufzuführen. In Zusammenhang mit Zugriff über das Netzwerk werden solche Angriffe auch als \textit{Remote Code Execution} bezeichnet und haben meist schwere Auswirkungen auf das betroffene System.
\par Eine weitere Technik ist \textit{T1528: Container service account}. Diese Technik befasst sich mit der Ausnutzung von Service-Konten, die zum Beispiel in Kubernetes für jede Einheit zur Ausführung von Containern angelegt werden. Service-Konten haben oft hohe Privilegien und ein Angriff über diese Technik kann verschiedene Taktiken verfolgen. Laut der \gls{tm4k} kann diese Technik für den Zugriff auf andere Zugangsberechtigungen, laterale Bewegung innerhalb des Systems und Persistenz genutzt werden \autocite{ContainerServiceAccount}.
Diese beiden Techniken bergen hohes Potenzial für schwere Auswirkungen in Kubernetes Umgebungen.
\par Die Auswirkung auf spezielle Komponenten in O-RAN wird über die Abbildung \ref{app:fig-acema-sum-threat} in Verbindung mit dem Report der \gls{wg11} ersichtlich \autocite{o-ranworkgroup11securityworkgroupORANSecurityThreat2024}. Die Abbildung zeigt die Summe der \gls{cvss} Gesamtbewertung über alle \glspl{cve} pro O-RAN \textit{Threat-ID} und Schweregrad. Auffallend sind vor allem die Summierungen, die einen Wert über 500 erreichen. Genaue Werte sind in Tabelle \ref{tab:top5-threats} dargestellt. Die höchste Summe erreicht dabei \textit{T-VM-C-01}, die in \autocite{o-ranworkgroup11securityworkgroupORANSecurityThreat2024} den Titel \textit{Abuse of a privileged VM/Container} trägt. Die \textit{Threat-ID} wurde in der manuellen Zuordnung acht \gls{mitre}-Techniken zugeordnet, darunter auch \textit{T1059} (vgl. Abbildung \ref{app:fig-acema-mean-teq}). Über den Report der O-RAN \gls{wg11} können Komponenten einer virtualisierten Umgebung und spezielle Komponenten aus der O-RAN Architektur (siehe Abbildung \ref{fig:oran-architecture}) identifiziert werden, die von einem Angriff aus dieser Kategorie betroffen sind. Für die genannte \textit{Threat-ID} sind das der \textit{Near-Real-Time} \gls{ric}, \gls{o-cu} und \gls{o-du} sowie das Hostbetriebsystem und die Virtualisierungsplattform.

\begin{table}[h]
    \centering
    \caption{Top 5 der O-RAN Threat-IDs, dessen zugeordnete CVEs eine hohe Summierung ihrer Werte nach CVSS zeigen.}
    \begin{tabular}{|l|l|}
        \hline
        Score & O-RAN Threat \\ \hline
        645.7 & T-VM-C-01    \\ \hline
        570.9 & T-IMG-01     \\ \hline
        560.4 & T-ADMIN-02   \\ \hline
        388.7 & T-O2-01      \\ \hline
        348.6 & T-HW-01      \\ \hline
    \end{tabular}
    \label{tab:top5-threats}
\end{table}

\subsection{Erfolg der Implementierung}
Die Implementierung wurde ohne große Hindernisse erfolgreich beendet. Alle Meilensteine wurden wie geplant erreicht. Besonders die Integration der Methode von \citeauthor{klementSecuring6GTransition2024} brachte einen großen Mehrwert für das Dashboard. Die Visualisierung der \gls{cvss} Daten in der Matrix und in der Detailseite von Artefakten liefen wertvolle Einblicke in die Bewertung der Auswirkungen der Angriffe. Die erstellten und im Dashboard angezeigten Diagramme liefern sowohl technische als auch wissenschaftliche Erkenntnisse.

Ein zentraler Fortschritt bei der Weiterentwicklung des Dashboards war die Visualisierung des Angriffspfads, der als interaktiver Graph die kritischen Informationen zu Angriffsmustern, Schwachstellen und genutzten Werkzeugen kompakt darstellt. Neben den \textit{MUST-Features} wurden weitere Funktionen wie die Verbesserung der Zeitleistenansicht und die Verlinkung zu weiterführenden Information über Techniken implementiert, welche die Benutzbarkeit verbessern und den Funktionsumfang des Dashboards erweitern. Insgesamt zeigt das Ergebnis, wie eine wissenschaftliche Herangehensweise an die Konzeption und Implementierung eines Dashboards die Analyse- und Visualisierungsfähigkeiten in einem \gls{dfir}-Umfeld erheblich verbessern kann. Die erfolgreiche Umsetzung belegt die Praxistauglichkeit der theoretisch erarbeiteten Methoden.

\subsection{Einsatz in der Praxis}
In Kapitel \ref{sec:auswahlDerEmpirischenMethode} wird die Existenz von anderen Mappingtools erwähnt. Diese erfüllen teilweise dieselbe Funktion wie \gls{acema}, bieten aber keine Möglichkeit der Integration von Bedrohungsdaten aus der spezialisierten O-RAN Umgebung.
\par Die umfangreichste Ansammlung von Zuordnungen wird im \textit{Mappings Explorer} vom \gls{mitre} \textit{Center for Threat-Informed Defense} gepflegt. Dieses Tool bietet nicht nur eine Möglichkeit zur Zuordnung von \gls{mitre}-Techniken zu \glspl{cve} und umgekehrt, sondern auch in weiterer Frameworks, die eine Art der Kategorisierung von Schwachstellen implementieren. Solche eigenen Frameworks werden zum Beispiel von großen Anbietern für Clouddienste wie Google, Amazon und Microsoft konzipiert. Mappings in diese Frameworks sind über den \textit{Mappings Explorer} erstellt und abrufbar. Eine Integration mit dem O-RAN Bedrohungsmodel gibt es bisher nicht \autocite{HomeMappingsExplorer}.
\par Ein simpleres Tool wird vom Forschungsteam \textit{Voyager18} des Unternehmens \textit{Vulcan Cyber} bereitgestellt. Es erlaubt das Mapping zwischen \gls{mitre}-Technik und \glspl{cve}, und umgekehrt \autocite{Vulcan}. Laut \autocite{keizmanMITREATTCKFramework2022} verbindet das Tool maschinelles Lernen und textuelle Analyse zum Finden von Mappings und soll für weitere Anwendungszwecke weiterentwickelt werden.
\par Eine stichprobenartige Analyse der gespeicherten Mappings der drei Mappingtools fand keine Übereinstimmung zwischen identifizierten \glspl{cve} für \gls{mitre}-Techniken. Diese Abweichungen sind auf die Anzahl von über 240.000 \glspl{cve} zurückzuführen. Durch die textuelle Analyse oder maschinelles Lernen ist es möglich, dass die Tools unterschiedliche \glspl{cve} für eine Technik oder umgekehrt finden. Die Unterschiede könnten auch aufgrund der Verwendung von verschiedenen Datenquellen entstehen.
\gls{acema} findet eine ausreichende Datenmenge, um eine aussagekräftige Datenanalyse durchzuführen, würde aber durch einen größeren Datensatz weiter verbessert werden. Die Implementierung des Dashboards ist aktuell schon in der Lage, in einer realen Umgebung eingesetzt zu werden, um die effektive Bewertung von Angriffen zu ermöglichen.

\section{Limitation}
\label{sec:limitationen}
Die Analyse und Implementierung unterliegt spezifischen Einschränkungen, die sowohl durch methodische als auch durch technologische Faktoren bedingt sind. Dabei sind insbesondere die Qualität und die Aktualität der genutzten Datenquellen zu betrachten.
\subsection{Generelle Limitationen}
\label{limitation-generell}
\par Die \gls{nvd} gilt als zentrale Ressource für Informationen über öffentlich bekannte Sicherheitslücken. Daher scheint es auch als verlässliche Quelle für die IT-Sicherheitsbranche und Forschungszwecke. Laut einer Veröffentlichung vom 13. Februar 2024 kommt das \gls{nist} nicht der Abarbeitung der eingereichten \glspl{cve} hinterher und arbeitet daran, die Verzögerung bei der Analyse zu beheben \autocite{NVDProgramAnnouncement}. Am 13. November 2024 kündigte das \gls{nist} an, alle neu eingereichten \gls{cve} direkt verarbeiten zu können. Die Abarbeitung der zurückgestellten Daten dauert weiterhin an. Die Daten aus der \gls{nvd} sind daher aktuell nicht auf dem neusten Stand \autocite{NationalVulnerabilityDatabase2024}. Eine vom \textit{IT Security Infrastructures Lab} der \textit{Friedrich-Alexander Universität Erlangen-Nürnberg} veröffentliche Studie vom \citedate{wunderNVDUsersAttitudes2024} unterlegt diese Feststellung mit empirischen Daten. Demnach sind fast 40\% der Befragten jährlich, monatlich, wöchentlich oder täglich von der verzögerten Veröffentlichung von neuen \glspl{cve} betroffen \autocite{wunderNVDUsersAttitudes2024}. Die damit zusammenhängenden und weitere technische Schwierigkeiten beeinflussen auch die Abfrageverfügbarkeit und Abfragegeschwindigkeit von Daten aus der \gls{nvd}. Für \gls{acema} haben die Einschränkungen weitreichende Konsequenzen, von verlangsamter Abfragegeschwindigkeit des \gls{cvss}s für \glspl{cve} bis hin zur vollständigen Abwesenheit von \gls{cvss} Daten, die eine integrale Rolle für die Datenanalyse spielen.
%
\par In der Sicherheitsforschung ist es essenziell, stets den neuesten Stand der Angriffe zu verfolgen, da Bedrohungslandschaften und Technologien sich kontinuierlich weiterentwickeln. Die Aktualität der verwendeten Methoden und Tests hat dabei unmittelbare Auswirkungen auf die Aussagekraft der Forschungsergebnisse. Insbesondere im Bereich Kubernetes nutzt das \gls{at} die Kommandos die von der Redguard \gls{ktm} zur Verfügung gestellt werden. Allerdings zeigt der Inhalt des HTTP-Headers \verb|Last-Modified|, dass die genutzte Quelle seit etwa zwei Jahren nicht mehr aktualisiert wurde, wie in Listing \ref{list:last-modified} zu sehen ist.

\begin{code}[caption=Abfrage des letzten Änderungsdatums der Kubernetes Threat Matrix von RedGuard, label={list:last-modified}]
    $ curl -I -k -s https://kubernetes-threat-matrix.redguard.ch/ | grep -i "Last-Modified"
    > last-modified: Fri, 04 Nov 2022 10:51:23 GMT
\end{code}

Die Änderungen, die am 7. Dezember 2022 in der Microsoft \gls{tm4k} vorgenommen wurden, wurden nie in die \gls{ktm} übernommen und es sind keine Kommandos vorhanden um die spezifischen Angriffe aus zwei neuen Techniken (\textit{Static Pods} und \textit{Collecting data from pod}) zu testen \autocite{weizmannMitigateThreatsNew2022}. Zwischen dem 1. Januar 2023 und dem 10. Dezember 2024 wurden auf der Kubernetes-eigenen Webseite 18 \glspl{cve} veröffentlich, auf die folglich nicht über die in der Redguard \gls{ktm} verfügbaren Kommandos getestet werden kann \autocite{OfficialCVEFeed}. Das Update vom 7. Dezember stellt auch die letzte dokumentierte Änderung an der \gls{tm4k} dar \autocite{YouSearchedThreat2022}. Wenn alle in der Zwischenzeit entdeckten Schwachstellen zu vorhandenen Techniken der \gls{tm4k} zugeordnet werden konnten, ist prinzipiell keine Aktualisierung nötig.

\subsection{Limitation von ACEMA}
\label{limitationen-acema}
Die Implementierung von \gls{acema} nutzt für die Bewertung das \gls{cvss} in Version 2 aus dem Jahr 2007 \autocite{Acema_oranOCloud_Data_GatheringpyMaster}. Seit dem 27. Juni 2024 unterstützt die \gls{nvd} das Bereitstellen von Daten in \textit{v4.0} des \gls{cvss}s \autocite{NVDCVSSV40}. Nicht nur ist die in \gls{acema} genutzte Version durch zwei \textit{major}-Versionen überholt, seit dem 13. Juli 2022 werden in der Datenbank keine neuen Angriffsvektordaten, qualitative Schweregrad-Bewertungen oder Schweregrad-Werte in \gls{cvss} Version 2 erstellt \autocite{RetirementCVSSV2}. Der Fall von unvollständigen Daten ist in der Bearbeitung dieses Projekts nicht vorgekommen, da alle im Ergebnisse des Mappings aufgeführten \glspl{cve} im Jahr 2021 oder davor veröffentlicht wurden. Es ist jedoch theoretisch möglich, dass diese Einschränkung bei der weiteren Nutzung dieser Methode zu fehlenden Daten führen kann.
%
\par Das von \gls{acema}, mithilfe des \gls{cti} Repositories, erstellte Mapping von \gls{mitre}-Technik zu \gls{capec} (Schritt 1 in Abbildung \ref{fig:mitre_mapping}) findet nicht alle \glspl{capec}. Die Dokumentation im Repository erklärt zu dem Finden von \glspl{capec}: \gls{capec} IDs können dort für die Techniken gefunden werden, wo unter externen Referenzen das Attribut \textit{source\_name} den Wert \verb|capec| hat \autocite{CtiUSAGEmdMaster} \autocite{CtiUSAGECAPECmdMaster}. \citeauthor{klementSecuring6GTransition2024} nutzen in ihrer Implementierung die Daten aus dem \textit{enterprise-attack/attack-pattern} Teil des Repositories \autocite{klement2023acema}. Nach demselben Prinzip kann auch der \textit{capec/2.1/attack-pattern} Teil des Repositories durchsucht werden. Hauptsächlich liegt der Unterschied zwischen den beiden Datensätzen darin, was der Hauptzweck der Daten ist. Der \textit{enterprise-attack} Teil enthält die Datenstruktur und Inhalte der \gls{mitre} \gls{attack} \textit{Enterprise}-Matrix, mit Daten wie der \gls{mitre}-Technik ID, Taktik und angreifbare Plattform sowie manchmal Referenzen zu \gls{mitre}-Techniken. Der \gls{capec} Teil enthält die Datenstruktur und Inhalte des \gls{capec}-Frameworks, mit Daten wie \gls{capec} ID, Konsequenzen und Voraussetzungen für die Ausnutzung sowie manchmal Referenzen zu \gls{mitre}-Techniken. Es zeigt sich in den Daten aus Tabelle \ref{tab:comparison_with_diff}, dass über den \textit{\gls{capec}} Teil eine vollständigere Abbildung von \gls{mitre}-Technik zu \gls{capec} ID möglich ist. Die beiden Implementierungen des Mappings wurden auf demselben Datensatz aus Anhang \ref{app:mapping-dataset} ausgeführt, der ein direkter Export der Daten aus der Dashboardmatrix ist.
%

\begin{table}[H]
    \centering
    \caption{Vergleich der Daten zwischen eigener Implementierung und ACEMA Implementierung}
    \begin{tabular}{|l|c|c|c|}
        \hline
        \textbf{Metrik}     & \textbf{Eigene Impl.} & \textbf{ACEMA Impl.} & \textbf{Differenz (\%)} \\
        \hline
        Techniken           & 27                    & 27                   & 0 \%                    \\
        \hline
        Techniken mit CAPEC & 14                    & 3                    & -75 \%                  \\
        \hline
        Einzigartige CAPECs & 25                    & 6                    & -76 \%                  \\
        \hline
        Einzigartige CWEs   & 39                    & 15                   & -62 \%                  \\
        \hline
    \end{tabular}
    \label{tab:comparison_with_diff}
\end{table}

\section{Ausblick}
\label{sec:ausblick}

Trotz des bereits hohen Funktionsumfangs und guter Anwendbarkeit des Dashboards gibt es Verbesserungspotenzial. Eine wesentliche Schwäche liegt in der manuellen Zuordnung bestimmter Daten wie der O-RAN \textit{Threat-IDs}, was zeitaufwändig und fehleranfällig ist. Hier könnte eine stärkere Automatisierung durch Machine-Learning-Ansätze Abhilfe schaffen. \citeauthor{klementSecuring6GTransition2024} kündigen in ihrem Artikel an, dass sich ihre zukünftigen Forschungen stark mit diesem Thema beschäftigen werden, mit dem Ziel den gesamten Mappingprozess zu automatisieren \autocite{klementSecuring6GTransition2024}. Der Einsatz von Daten aus \gls{cvss} in Version 2 sollte bei anhaltender Nutzung der Methode eingestellt und zugunsten von Version 4 ersetzt werden. Die Version 4 des \gls{cvss}s wurde am 1. November 2023 veröffentlicht und weiterhin fortlaufend verbessert. Die neue Version bietet laut \citeauthor{dugalAnnouncingCVSSV40} eine feinere Granularität und viele weitere Verbesserungen \autocite{dugalAnnouncingCVSSV40}. Zukünftig wäre die Implementierung einer Live-Aktualisierung für Artefaktdaten und Angriffspfadvisualisierungen wünschenswert, um auch bei dynamischen Angriffssimulationen stets aktuelle Informationen bereitzustellen. Ein weiteres Verbesserungspotenzial besteht in der Performanceoptimierung, insbesondere bei der Darstellung großer Datenmengen, wie sie bei der Analyse umfangreicher Artefaktsammlungen auftreten können. Hier könnten zum Beispiel bewährte Methoden wie \textit{Chunking} oder \textit{Lazy Loading} eingesetzt werden, um große Datenmengen nacheinander in kleineren \textit{Chunks} zu laden.
\par Die Funktionalität des Dashboards ist nicht an die Anwendung auf eine bestimmte Technologie gebunden, sondern kann auf weitere Umgebungen übertragen werden. Die Daten aus \gls{acema} können weiter genutzt werden, solange sich die Angriffe mithilfe von \gls{mitre}-Techniken ausdrücken lassen. Es ist daher denkbar, das Dashboard in Verbindung mit dem etablierten \gls{at}-Framework in der sich verändernden \gls{open-ran} Umgebung auch zukünftigen mit Technologien wie 6G zu nutzen.
